<!DOCTYPE html>
<html lang="en" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<!--    <div id="app">
        {{ message}}
    </div>-->

    <div id="app2">
      <button @click="send">按钮</button>
      <button @click="send01">按钮01</button>
      <button @click="send02">按钮02</button>
      <button @click="send03">按钮03</button>
        <img :src="this.src">
        <p>{{this.src}}</p>
    </div>

    <!-- 生产环境版本，优化了尺寸和速度 -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
       var app = new Vue({
            el: '#app2',
            data: {
                src:""
            },
           methods: {
               send(){
                   axios({
                       method: 'get',
                       url: 'http://localhost:40155/system/particulars/generateContract',
                   }).then(function (response) {
                       var binaryData = [];
                       binaryData.push(response);
                       this.src = window.URL.createObjectURL(new Blob(binaryData, {
                           type: "application/word"
                       }))
                       console.log(binaryData);
                       console.log(this.src);
                   })
               },
               send01(){
                   axios({
                       method: 'get',
                       url: 'http://localhost:40155/system/particulars/generateContract',
                   }).then(function (res) {
                       //获取文件名
                       const fileName = res.headers["Content-Disposition"].split(";")[1].split("=")[1]
                       const blob = new Blob([res.data]);
                       //创建一个a标签并设置href属性，之后模拟人为点击下载文件
                       let link = document.createElement('a');
                       link.href = window.URL.createObjectURL(blob);
                       link.download = fileName;//设置下载文件名
                       link.click();//模拟点击
                       //释放资源并删除创建的a标签
                       URL.revokeObjectURL(link.href);
                       document.body.removeChild(link);
                   })
               },
               send02(){
                   axios({
                       method: 'get',
                       url: 'http://localhost:40155/system/particulars/generateContract',
                   }).then(function (res) {
                       //res为接口所返回的文件流
                       var blob = new Blob([res], {
                           type: "application/pdf;chartset=UTF-8"
                       });
                       console.log(blob);
                       //var url = window.URL.createObjectURL(blob);
                       //新窗口打开
                       var link = document.createElement('a');
                       link.href = window.URL.createObjectURL(blob);
                       link.target = "_blank";
                       link.click();

                   })
               },
               send03(){
                   axios({
                       method: 'get',
                       url: 'http://localhost:40155/system/particulars/getPDFUrl',
                   }).then(function (res) {
                       console.log(res)
                       console.log(res.data.data)

                   })
               },


           }

        })



    </script>

</body>


</html>